

_SQL Practice Questions
---------------------------------


1. Get all customers whose first name starts with 'J' and who are active.
select * from customer
where first_name like 'J%' and active=1 

2. Find all films where the title contains the word 'ACTION' or the description contains 'WAR'.
select title,description from film
where  title like '%ACTION%' or description like '%WAR%' 
3. List all customers whose last name is not 'SMITH' and whose first name ends with 'a'.
select Last_name,first_name from customer
where last_name!='SMITH' and first_name like'%e'
4. Get all films where the rental rate is greater than 3.0 and the replacement cost is not null.
select * from film 
where rental_rate>3.0 and replacement_cost is not null;
5.Count how many customers exist in each store who have active status = 1.
SELECT store_id,
       COUNT(customer_id) AS active_customers
FROM customer
WHERE active = 1
GROUP BY store_id;

6. Show distinct film ratings available in the film table.
select distinct rating from film;

select rental_duration from film;

7. Find the number of films for each rental duration where the average length is more than 100 minutes.
SELECT rental_duration,
       COUNT(film_id) AS film_count
FROM film
GROUP BY rental_duration
HAVING AVG(length) > 100;

8. List payment_date and total amount paid per date, but only include days where more than 100 payments were made.
select count(payment_id),payment_date,sum(amount)as total_amount
from payment
group by payment_date
having count(payment_id)>100;
9. Find customers whose email address is null or ends with '.org'.
select  email from customer
where email is not null or email like '%.org'

customerspayment
10. List all films with rating 'PG' or 'G', and order them by rental rate in descending order.
select title,rental_rate,rating from film
where rating = 'NC-17' or rating= 'PG-13'
order by rental_rate desc;
--or--
select distinct rating from film;
select title,rental_rate,rating from film
where rating IN('NC-17','PG-13')
order by rental_rate desc;

select * from film;
11. Count how many films exist for each length where the film title starts with 'T' and the count is more than 5.
SELECT length, COUNT(film_id) AS film_count
FROM film
WHERE title LIKE 'T%'
GROUP BY length
HAVING COUNT(film_id) > 5;

12. List all actors who have appeared in more than 10 films.

SELECT f.first_name, f.last_name, COUNT(fa.film_id) AS film_count
FROM actor AS f
JOIN film_actor AS fa 
  ON f.actor_id = fa.actor_id
GROUP BY f.actor_id, f.first_name, f.last_name
HAVING COUNT(fa.film_id) > 10
ORDER BY film_count DESC;

13. Find the top 5 films with the highest rental rates and longest lengths combined, ordering by rental rate first and length second.
SELECT title, rental_rate, length
FROM film
ORDER BY rental_rate DESC, length DESC
LIMIT 5;
14. Show all customers along with the total number of rentals they have made, ordered from most to least rentals.
SELECT 
    c.customer_id,
    CONCAT(c.first_name, ' ', c.last_name) AS customer_name,
    COUNT(r.rental_id) AS total_rentals
FROM customer c
LEFT JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id
ORDER BY total_rentals DESC;

15. List the film titles that have never been rented.
SELECT title
FROM film
WHERE film_id NOT IN (
    SELECT DISTINCT film_id
    FROM inventory
    JOIN rental USING(inventory_id)
);

16. Find all staff members along with the total payments they have processed, ordered by total payment amount in descending order.
SELECT 
    s.staff_id,
    CONCAT(s.first_name, ' ', s.last_name) AS staff_name,
    SUM(p.amount) AS total_payments
FROM staff s
JOIN payment p ON s.staff_id = p.staff_id
GROUP BY s.staff_id
ORDER BY total_payments DESC;
17. Show the category name along with the total number of films in each category.
SELECT 
    c.name AS category_name,
    COUNT(fc.film_id) AS film_count
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
GROUP BY c.category_id;
18. List the top 3 customers who have spent the most money in total.
SELECT 
    c.customer_id,
    CONCAT(c.first_name, ' ', c.last_name) AS customer_name,
    SUM(p.amount) AS total_spent
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
GROUP BY c.customer_id
ORDER BY total_spent DESC
LIMIT 3;
19. Find all films that were rented in the month of May (any year) and have a rental duration greater than 5 days.
SELECT 
    f.title,
    r.rental_date,
    DATEDIFF(r.return_date, r.rental_date) AS rental_days
FROM rental r
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE MONTH(r.rental_date) = 5
  AND DATEDIFF(r.return_date, r.rental_date) > 5;
20. Get the average rental rate for each film category, but only include categories with more than 50 films.
SELECT 
    c.name AS category_name,
    AVG(f.rental_rate) AS avg_rental_rate
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.category_id
HAVING COUNT(fc.film_id) > 50;

