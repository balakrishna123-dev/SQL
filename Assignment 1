
SQL Practice Questions
---------------------------------
üß† SQL Practice Questions with Answers (Using Sakila Database)
1Ô∏è‚É£ Get all customers whose first name starts with 'J' and who are active.

Explanation: Use LIKE 'J%' for pattern matching and filter with active = 1.

SELECT customer_id, first_name, last_name, email
FROM customer
WHERE first_name LIKE 'J%' AND active = 1;

2Ô∏è‚É£ Find all films where the title contains the word 'ACTION' or the description contains 'WAR'.
SELECT film_id, title, description
FROM film
WHERE title LIKE '%ACTION%' OR description LIKE '%WAR%';

3Ô∏è‚É£ List all customers whose last name is not 'SMITH' and whose first name ends with 'a'.
SELECT customer_id, first_name, last_name
FROM customer
WHERE last_name <> 'SMITH' AND first_name LIKE '%a';

4Ô∏è‚É£ Get all films where the rental rate is greater than 3.0 and the replacement cost is not null.
SELECT film_id, title, rental_rate, replacement_cost
FROM film
WHERE rental_rate > 3.0 AND replacement_cost IS NOT NULL;

5Ô∏è‚É£ Count how many customers exist in each store who have active status = 1.
SELECT store_id, COUNT(customer_id) AS active_customers
FROM customer
WHERE active = 1
GROUP BY store_id;

6Ô∏è‚É£ Show distinct film ratings available in the film table.
SELECT DISTINCT rating
FROM film;

7Ô∏è‚É£ Find the number of films for each rental duration where the average length is more than 100 minutes.
SELECT rental_duration, COUNT(*) AS total_films, AVG(length) AS avg_length
FROM film
GROUP BY rental_duration
HAVING AVG(length) > 100;

8Ô∏è‚É£ List payment dates and total amount paid per date, but only include days where more than 100 payments were made.
SELECT payment_date, SUM(amount) AS total_amount, COUNT(payment_id) AS total_payments
FROM payment
GROUP BY DATE(payment_date)
HAVING COUNT(payment_id) > 100;

9Ô∏è‚É£ Find customers whose email address is null or ends with '.org'.
SELECT customer_id, first_name, last_name, email
FROM customer
WHERE email IS NULL OR email LIKE '%.org';

üîü List all films with rating 'PG' or 'G', and order them by rental rate in descending order.
SELECT film_id, title, rating, rental_rate
FROM film
WHERE rating IN ('PG', 'G')
ORDER BY rental_rate DESC;

11Ô∏è‚É£ Count how many films exist for each length where the film title starts with 'T' and the count is more than 5.
SELECT length, COUNT(film_id) AS film_count
FROM film
WHERE title LIKE 'T%'
GROUP BY length
HAVING COUNT(film_id) > 5;

12Ô∏è‚É£ List all actors who have appeared in more than 10 films.
SELECT a.actor_id, a.first_name, a.last_name, COUNT(fa.film_id) AS film_count
FROM actor a
JOIN film_actor fa ON a.actor_id = fa.actor_id
GROUP BY a.actor_id, a.first_name, a.last_name
HAVING COUNT(fa.film_id) > 10;

13Ô∏è‚É£ Find the top 5 films with the highest rental rates and longest lengths combined.
SELECT film_id, title, rental_rate, length
FROM film
ORDER BY rental_rate DESC, length DESC
LIMIT 5;

14Ô∏è‚É£ Show all customers along with the total number of rentals they have made, ordered from most to least rentals.
SELECT c.customer_id, c.first_name, c.last_name, COUNT(r.rental_id) AS total_rentals
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id, c.first_name, c.last_name
ORDER BY total_rentals DESC;

15Ô∏è‚É£ List the film titles that have never been rented.
SELECT f.film_id, f.title
FROM film f
LEFT JOIN inventory i ON f.film_id = i.film_id
LEFT JOIN rental r ON i.inventory_id = r.inventory_id
WHERE r.rental_id IS NULL;

16Ô∏è‚É£ Find all staff members along with the total payments they have processed, ordered by total payment amount.
SELECT s.staff_id, s.first_name, s.last_name, SUM(p.amount) AS total_amount
FROM staff s
JOIN payment p ON s.staff_id = p.staff_id
GROUP BY s.staff_id, s.first_name, s.last_name
ORDER BY total_amount DESC;

17Ô∏è‚É£ Show the category name along with the total number of films in each category.
SELECT c.name AS category_name, COUNT(fc.film_id) AS total_films
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
GROUP BY c.name
ORDER BY total_films DESC;

18Ô∏è‚É£ List the top 3 customers who have spent the most money in total.
SELECT c.customer_id, c.first_name, c.last_name, SUM(p.amount) AS total_spent
FROM customer c
JOIN payment p ON c.customer_id = p.customer_id
GROUP BY c.customer_id, c.first_name, c.last_name
ORDER BY total_spent DESC
LIMIT 3;

19Ô∏è‚É£ Find all films that were rented in the month of May (any year) and have a rental duration greater than 5 days.
SELECT DISTINCT f.film_id, f.title, f.rental_duration
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
WHERE MONTH(r.rental_date) = 5 AND f.rental_duration > 5;

20Ô∏è‚É£ Get the average rental rate for each film category, but only include categories with more than 50 films.
SELECT c.name AS category_name, AVG(f.rental_rate) AS avg_rental_rate, COUNT(f.film_id) AS total_films
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
HAVING COUNT(f.film_id) > 50
ORDER BY avg_rental_rate DESC;


